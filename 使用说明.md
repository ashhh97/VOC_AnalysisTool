# VOC分析工具使用说明

## 快速开始

### 1. 安装依赖

#### 前端依赖
```bash
npm install
```

#### 后端依赖
```bash
cd backend
pip install -r requirements.txt
```

### 2. 启动服务

#### 方式一：使用启动脚本（推荐）
```bash
./start.sh
```

#### 方式二：手动启动

**终端1 - 启动后端：**
```bash
cd backend
python app.py
```

**终端2 - 启动前端：**
```bash
npm run dev
```

### 3. 访问应用

打开浏览器访问：http://localhost:3000

## 使用步骤

1. **上传Excel文件**
   - 点击上传区域或拖拽Excel文件
   - 支持 .xlsx 和 .xls 格式
   - 文件会自动上传并显示在在线编辑器中

2. **查看原始数据**
   - 上传成功后，可以在在线表格编辑器中查看和编辑原始数据
   - 原始数据不会被修改

3. **开始AI分析**
   - 点击"开始AI分析"按钮
   - 系统会自动：
     - 识别用户反馈内容
     - 分析情感（正面/负面/中性）
     - 按问题类型分类
     - 创建新的Sheet展示分析结果

4. **查看分析结果**
   - 在新建的Sheet中查看分类结果
   - 同类问题已归为一类
   - 每个分类前有分类标题和情感标签
   - 分类标题和情感标签使用合并单元格显示

## Excel文件格式要求

### 推荐格式
- 第一行为表头
- 包含用户反馈内容的列（系统会自动识别包含以下关键词的列）：
  - "反馈"
  - "意见"
  - "评论"
  - "评价"
  - "内容"

### 示例格式
| 用户ID | 反馈内容 | 时间 |
|--------|----------|------|
| U001   | 功能很好用，界面美观 | 2024-01-01 |
| U002   | 加载速度太慢了 | 2024-01-02 |

## 功能说明

### AI分析功能
- **情感识别**：自动识别用户反馈是正面、负面还是中性
- **问题分类**：将反馈分为以下类别：
  - 功能问题
  - 性能问题
  - 界面问题
  - 体验问题
  - 服务问题
  - 价格问题
  - 其他问题

### 在线编辑功能
- 支持实时编辑表格内容
- 支持添加/删除行列
- 支持复制粘贴
- 支持多个Sheet切换

### 分析结果展示
- 保留原始数据Sheet
- 新建分析结果Sheet
- 同类问题自动归类
- 合并单元格显示分类标题和情感

## 注意事项

1. **文件大小**：建议上传的Excel文件不超过10MB
2. **数据格式**：确保Excel文件格式正确，第一行为表头
3. **网络连接**：首次使用AI分析可能需要网络连接（使用Hugging Face API）
4. **浏览器兼容**：建议使用Chrome、Edge或Firefox浏览器

## 故障排除

### 上传失败
- 检查文件格式是否为.xlsx或.xls
- 检查文件是否损坏
- 检查后端服务是否正常运行

### AI分析失败
- 检查网络连接
- 系统会自动切换到本地规则分析
- 本地分析基于关键词匹配，准确度可能略低

### 表格显示异常
- 刷新页面重试
- 检查浏览器控制台是否有错误信息
- 确保Luckysheet资源加载成功

## 技术支持

如遇到问题，请检查：
1. 后端日志（终端1）
2. 前端控制台（浏览器F12）
3. 确保所有依赖已正确安装

